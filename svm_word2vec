{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "e2cae695",
   "metadata": {},
   "source": [
    "Following https://medium.com/technovators/machine-learning-based-multi-label-text-classification-9a0e17f88bb4"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "dab1f7b5",
   "metadata": {},
   "outputs": [],
   "source": [
    "import sys"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "12a09fd0",
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.svm import LinearSVC\n",
    "from sklearn.multiclass import OneVsRestClassifier\n",
    "from sklearn.calibration import CalibratedClassifierCV\n",
    "from sklearn.feature_extraction.text import TfidfVectorizer\n",
    "from sklearn.preprocessing import MultiLabelBinarizer\n",
    "from sklearn import metrics\n",
    "from sklearn.pipeline import Pipeline\n",
    "from sklearn.metrics import accuracy_score, precision_score, recall_score, f1_score, confusion_matrix\n",
    "\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "import pickle\n",
    "import json\n",
    "\n",
    "import matplotlib.pyplot as plt\n",
    "import scipy\n",
    "import gensim\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "38659523",
   "metadata": {},
   "outputs": [],
   "source": [
    "train_dict = pickle.load(open('../nlp_project/train.pkl', 'rb'))\n",
    "valid_dict = pickle.load(open('../nlp_project/valid.pkl', 'rb'))\n",
    "test_dict = pickle.load(open('../nlp_project/test.pkl', 'rb'))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "9070ff0a",
   "metadata": {},
   "outputs": [],
   "source": [
    "# combine valid and test - approx 80/20 split\n",
    "test_dict = {**valid_dict, **test_dict}"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "a3f1d507",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "{'input': '[Renin-Angiotensin-System (RAS) and COVID-19 - On The Prescription of RAS Blockers]. Twenty years ago, an enzyme homologous to the previously known angiotensin-converting enzyme (ACE) was identified, and subsequently named ACE2. In the renin-angiotensin system (RAS), ACE2 has counter-regulatory functions against the classical effector peptide angiotensin II, for example in blood pressure regulation and cardiovascular remodeling. However, ACE2 provides an initially unexpected interesting link between virology and cardiovascular medicine. That is, ACE2 represents the binding receptor for the cellular uptake of SARS-CoV and SARS-CoV-2 viruses. Thus, ACE2 is relevant for COVID-19. In this context, it was suspected that therapy with RAS blockers might promote transmission and complications of COVID-19 by upregulation of ACE2 expression. The aim of this short review is, to describe the link between the RAS, particularly ACE2, and COVID-19. Based on our analysis and evaluation of the available findings, we justify our conclusion: important drugs such as ACE inhibitors and angiotensin receptor blockers should continue to be prescribed according to guidelines to stable patients in the context of the COVID-19 pandemic.',\n",
       " 'label': 'Treatment;Mechanism',\n",
       " 'label_vec': [0, 0, 0, 0, 1, 0, 0, 1, 0],\n",
       " 'lemmas': ['Renin',\n",
       "  'Angiotensin',\n",
       "  'System',\n",
       "  'RAS',\n",
       "  'covid-19',\n",
       "  'Prescription',\n",
       "  'RAS',\n",
       "  'Blockers',\n",
       "  'twenty',\n",
       "  'year',\n",
       "  'ago',\n",
       "  'enzyme',\n",
       "  'homologous',\n",
       "  'previously',\n",
       "  'know',\n",
       "  'angiotensin',\n",
       "  'convert',\n",
       "  'enzyme',\n",
       "  'ACE',\n",
       "  'identify',\n",
       "  'subsequently',\n",
       "  'name',\n",
       "  'ACE2',\n",
       "  'renin',\n",
       "  'angiotensin',\n",
       "  'system',\n",
       "  'RAS',\n",
       "  'ACE2',\n",
       "  'counter',\n",
       "  'regulatory',\n",
       "  'function',\n",
       "  'classical',\n",
       "  'effector',\n",
       "  'peptide',\n",
       "  'angiotensin',\n",
       "  'II',\n",
       "  'example',\n",
       "  'blood',\n",
       "  'pressure',\n",
       "  'regulation',\n",
       "  'cardiovascular',\n",
       "  'remodeling',\n",
       "  'however',\n",
       "  'ACE2',\n",
       "  'provide',\n",
       "  'initially',\n",
       "  'unexpected',\n",
       "  'interesting',\n",
       "  'link',\n",
       "  'virology',\n",
       "  'cardiovascular',\n",
       "  'medicine',\n",
       "  'ACE2',\n",
       "  'represent',\n",
       "  'bind',\n",
       "  'receptor',\n",
       "  'cellular',\n",
       "  'uptake',\n",
       "  'SARS',\n",
       "  'CoV',\n",
       "  'SARS',\n",
       "  'CoV-2',\n",
       "  'virus',\n",
       "  'thus',\n",
       "  'ACE2',\n",
       "  'relevant',\n",
       "  'covid-19',\n",
       "  'context',\n",
       "  'suspect',\n",
       "  'therapy',\n",
       "  'RAS',\n",
       "  'blocker',\n",
       "  'might',\n",
       "  'promote',\n",
       "  'transmission',\n",
       "  'complication',\n",
       "  'covid-19',\n",
       "  'upregulation',\n",
       "  'ACE2',\n",
       "  'expression',\n",
       "  'aim',\n",
       "  'short',\n",
       "  'review',\n",
       "  'describe',\n",
       "  'link',\n",
       "  'RAS',\n",
       "  'particularly',\n",
       "  'ACE2',\n",
       "  'covid-19',\n",
       "  'base',\n",
       "  'analysis',\n",
       "  'evaluation',\n",
       "  'available',\n",
       "  'finding',\n",
       "  'justify',\n",
       "  'conclusion',\n",
       "  'important',\n",
       "  'drug',\n",
       "  'ACE',\n",
       "  'inhibitor',\n",
       "  'angiotensin',\n",
       "  'receptor',\n",
       "  'blocker',\n",
       "  'continue',\n",
       "  'prescribe',\n",
       "  'accord',\n",
       "  'guideline',\n",
       "  'stable',\n",
       "  'patient',\n",
       "  'context',\n",
       "  'COVID-19',\n",
       "  'pandemic'],\n",
       " 'embeddings': array([[-0.19891  , -0.1026   , -0.86307  , ...,  0.025575 , -0.32909  ,\n",
       "          0.20973  ],\n",
       "        [ 0.26232  , -0.074785 , -1.2471   , ...,  0.031366 , -0.39809  ,\n",
       "          0.041972 ],\n",
       "        [-0.56907  ,  0.29066  ,  0.40035  , ...,  0.49422  ,  0.32091  ,\n",
       "         -0.41983  ],\n",
       "        ...,\n",
       "        [-0.36578  ,  0.39335  , -0.74142  , ...,  0.45449  ,  0.025694 ,\n",
       "          0.17137  ],\n",
       "        [ 0.       ,  0.       ,  0.       , ...,  0.       ,  0.       ,\n",
       "          0.       ],\n",
       "        [-0.42666  ,  0.33154  , -0.0032541, ...,  0.27321  , -0.71865  ,\n",
       "          0.3213   ]], dtype=float32)}"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train_dict[list(train_dict.keys())[0]]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "8a3cbc4e",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Save certain keys only\n",
    "\n",
    "def load_dict(d:dict):\n",
    "    \n",
    "    d_new = {i:{'input': d[i]['input'],\n",
    "                 'label': d[i]['label'].split(';'),\n",
    "                 'label_vec': d[i]['label_vec'], \n",
    "                 'lemmas': d[i]['lemmas']}\n",
    "              for i in d\n",
    "              if len(d[i]['lemmas']) != 0}\n",
    "    \n",
    "    return d_new\n",
    "\n",
    "\n",
    "train_dict = load_dict(train_dict)\n",
    "# valid_dict = load_dict(valid_dict)\n",
    "test_dict = load_dict(test_dict)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "f6ce8f57",
   "metadata": {},
   "outputs": [],
   "source": [
    "train_data = pd.DataFrame.from_dict(train_dict, orient='index')\n",
    "# valid_data = pd.DataFrame.from_dict(valid_dict, orient='index')\n",
    "test_data = pd.DataFrame.from_dict(test_dict, orient='index')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "89e50454",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>input</th>\n",
       "      <th>label</th>\n",
       "      <th>label_vec</th>\n",
       "      <th>lemmas</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>PMID:32323279</th>\n",
       "      <td>[Renin-Angiotensin-System (RAS) and COVID-19 -...</td>\n",
       "      <td>[Treatment, Mechanism]</td>\n",
       "      <td>[0, 0, 0, 0, 1, 0, 0, 1, 0]</td>\n",
       "      <td>[Renin, Angiotensin, System, RAS, covid-19, Pr...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PMID:32678526</th>\n",
       "      <td>Weaning From Exogenous Sedation in the Era of ...</td>\n",
       "      <td>[Prevention]</td>\n",
       "      <td>[0, 0, 0, 0, 0, 1, 0, 0, 0]</td>\n",
       "      <td>[Weaning, Exogenous, Sedation, Era, COVID-19, ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PMID:32302385</th>\n",
       "      <td>Letter: Rongeurs, Neurosurgeons, and COVID-19:...</td>\n",
       "      <td>[Prevention]</td>\n",
       "      <td>[0, 0, 0, 0, 0, 1, 0, 0, 0]</td>\n",
       "      <td>[letter, Rongeurs, Neurosurgeons, covid-19, pr...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PMID:32816435</th>\n",
       "      <td>Impact and Mechanism of Covid-19 on Mental Hea...</td>\n",
       "      <td>[]</td>\n",
       "      <td>[0, 0, 0, 0, 0, 0, 0, 0, 1]</td>\n",
       "      <td>[impact, Mechanism, Covid-19, Mental, Health, ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PMID:32974671</th>\n",
       "      <td>The implications of vitamin D deficiency on CO...</td>\n",
       "      <td>[Treatment]</td>\n",
       "      <td>[0, 0, 0, 0, 0, 0, 0, 1, 0]</td>\n",
       "      <td>[implication, vitamin, deficiency, covid-19, r...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                                           input  \\\n",
       "PMID:32323279  [Renin-Angiotensin-System (RAS) and COVID-19 -...   \n",
       "PMID:32678526  Weaning From Exogenous Sedation in the Era of ...   \n",
       "PMID:32302385  Letter: Rongeurs, Neurosurgeons, and COVID-19:...   \n",
       "PMID:32816435  Impact and Mechanism of Covid-19 on Mental Hea...   \n",
       "PMID:32974671  The implications of vitamin D deficiency on CO...   \n",
       "\n",
       "                                label                    label_vec  \\\n",
       "PMID:32323279  [Treatment, Mechanism]  [0, 0, 0, 0, 1, 0, 0, 1, 0]   \n",
       "PMID:32678526            [Prevention]  [0, 0, 0, 0, 0, 1, 0, 0, 0]   \n",
       "PMID:32302385            [Prevention]  [0, 0, 0, 0, 0, 1, 0, 0, 0]   \n",
       "PMID:32816435                      []  [0, 0, 0, 0, 0, 0, 0, 0, 1]   \n",
       "PMID:32974671             [Treatment]  [0, 0, 0, 0, 0, 0, 0, 1, 0]   \n",
       "\n",
       "                                                          lemmas  \n",
       "PMID:32323279  [Renin, Angiotensin, System, RAS, covid-19, Pr...  \n",
       "PMID:32678526  [Weaning, Exogenous, Sedation, Era, COVID-19, ...  \n",
       "PMID:32302385  [letter, Rongeurs, Neurosurgeons, covid-19, pr...  \n",
       "PMID:32816435  [impact, Mechanism, Covid-19, Mental, Health, ...  \n",
       "PMID:32974671  [implication, vitamin, deficiency, covid-19, r...  "
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train_data.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "bfc53dcd",
   "metadata": {},
   "outputs": [],
   "source": [
    "comb_df=train_data.append(test_data)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "ce4c89e6",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "1238\n",
      "102\n",
      "CPU times: user 43.6 ms, sys: 240 µs, total: 43.8 ms\n",
      "Wall time: 43.1 ms\n"
     ]
    }
   ],
   "source": [
    "%%time\n",
    "# Word2Vec the lemmas\n",
    "train_lemma_l = list(comb_df['lemmas'])\n",
    "max_lem_vals = max(len(x) for x in train_lemma_l)\n",
    "print(max_lem_vals)\n",
    "mean_lem_vals = sum(len(x) for x in train_lemma_l)/len(train_lemma_l)\n",
    "print(round(mean_lem_vals))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "d5404c94",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "CPU times: user 6min 26s, sys: 5.08 s, total: 6min 31s\n",
      "Wall time: 2min 12s\n"
     ]
    }
   ],
   "source": [
    "%%time\n",
    "model = gensim.models.Word2Vec(train_lemma_l,\n",
    "                 vector_size=max_lem_vals) # picking a vector size higher than the mean lemma counts"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "d6d22842",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[('vaccination', 0.6648397445678711),\n",
       " ('cure', 0.5051326155662537),\n",
       " ('antiviral', 0.49977269768714905),\n",
       " ('countermeasure', 0.49201810359954834),\n",
       " ('immunization', 0.47565406560897827),\n",
       " ('candidate', 0.4679791331291199),\n",
       " ('discovery', 0.463651567697525),\n",
       " ('drug', 0.45453348755836487),\n",
       " ('eradication', 0.4531054198741913),\n",
       " ('BCG', 0.44754302501678467)]"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "model.wv.most_similar(\"vaccine\")\n",
    "# testing out word similarities"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "e792b668",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "1238"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "wordvectdict=dict(zip(model.wv.index_to_key,model.wv.vectors))\n",
    "len(wordvectdict[list(wordvectdict.keys())[0]])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "d1ab2cbb",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "PMID:32323279    [0, 0, 0, 0, 1, 0, 0, 1, 0]\n",
       "PMID:32678526    [0, 0, 0, 0, 0, 1, 0, 0, 0]\n",
       "PMID:32302385    [0, 0, 0, 0, 0, 1, 0, 0, 0]\n",
       "PMID:32816435    [0, 0, 0, 0, 0, 0, 0, 0, 1]\n",
       "PMID:32974671    [0, 0, 0, 0, 0, 0, 0, 1, 0]\n",
       "                            ...             \n",
       "PMID:32984792    [0, 0, 0, 0, 0, 0, 0, 1, 0]\n",
       "PMID:32882706    [0, 0, 0, 0, 1, 0, 0, 1, 0]\n",
       "PMID:32904944    [0, 0, 0, 0, 1, 0, 0, 1, 0]\n",
       "PMID:32837019    [0, 0, 0, 0, 0, 0, 0, 0, 1]\n",
       "PMID:32611659    [1, 0, 0, 0, 0, 0, 0, 0, 0]\n",
       "Name: label_vec, Length: 52416, dtype: object"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train_data[\"label_vec\"]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "b4faa34a",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "CPU times: user 81 ms, sys: 12 ms, total: 93 ms\n",
      "Wall time: 92.1 ms\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "array([[0, 0, 0, 0, 0, 1, 0, 0, 1],\n",
       "       [0, 0, 0, 0, 0, 0, 1, 0, 0],\n",
       "       [0, 0, 0, 0, 0, 0, 1, 0, 0],\n",
       "       [1, 0, 0, 0, 0, 0, 0, 0, 0],\n",
       "       [0, 0, 0, 0, 0, 0, 0, 0, 1],\n",
       "       [0, 0, 1, 0, 0, 0, 0, 0, 0],\n",
       "       [1, 0, 0, 0, 0, 0, 0, 0, 0],\n",
       "       [0, 0, 0, 0, 0, 0, 1, 0, 0],\n",
       "       [0, 0, 0, 0, 0, 1, 0, 0, 1],\n",
       "       [0, 0, 1, 0, 0, 0, 0, 0, 1]])"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%time\n",
    "mlb = MultiLabelBinarizer()\n",
    "train_labels = mlb.fit_transform(train_data['label'])\n",
    "test_labels = mlb.transform(test_data['label'])\n",
    "train_labels[0:10]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "ceda619d",
   "metadata": {},
   "outputs": [],
   "source": [
    "class AverageEmbeddingVectorizer(object):\n",
    "    def __init__(self, word2vec):\n",
    "        self.word2vec = word2vec\n",
    "        self.dim =1238 # because we use the vector size assigned \n",
    "\n",
    "    def fit(self, X, y):\n",
    "        return self\n",
    "\n",
    "    def transform(self, X):\n",
    "        return np.array([\n",
    "            np.mean([self.word2vec[w] for w in words if w in self.word2vec]\n",
    "                    or [np.zeros(self.dim)], axis=0)\n",
    "            # if a text is empty we should return a vector of zeros\n",
    "            # with the same dimensionality as all the other vectors\n",
    "            for words in X\n",
    "        ])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "5c8a368f",
   "metadata": {},
   "outputs": [],
   "source": [
    "# testing_output= np.array([\n",
    "#             np.mean([wordvectdict[w] for w in words if w in wordvectdict]\n",
    "#                     or [np.zeros(150)], axis=0)\n",
    "#             for words in train_data[\"lemmas\"]\n",
    "#         ])\n",
    "# testing_output[0:5]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "1d6b04b2",
   "metadata": {},
   "outputs": [],
   "source": [
    "pipe = Pipeline([(\"wordvect\",AverageEmbeddingVectorizer(wordvectdict)),\n",
    "                (\"multilabel\",OneVsRestClassifier(LinearSVC(), n_jobs=-1))])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "2d29668f",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "CPU times: user 24.6 s, sys: 2.97 s, total: 27.6 s\n",
      "Wall time: 4min 17s\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "Pipeline(steps=[('wordvect',\n",
       "                 <__main__.AverageEmbeddingVectorizer object at 0x7f1f6b38fa60>),\n",
       "                ('multilabel',\n",
       "                 OneVsRestClassifier(estimator=LinearSVC(), n_jobs=-1))])"
      ]
     },
     "execution_count": 19,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%time\n",
    "pipe.fit(train_data['lemmas'],train_labels)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "67810a8e",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "CPU times: user 7.59 s, sys: 5.37 s, total: 13 s\n",
      "Wall time: 6.76 s\n"
     ]
    }
   ],
   "source": [
    "%%time\n",
    "predicted=pipe.predict(test_data['lemmas'])\n",
    "svmpredDF = pipe.decision_function(test_data['lemmas'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "64b69c95",
   "metadata": {},
   "outputs": [],
   "source": [
    "pred_f = np.array(predicted)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "a182e634",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([[0, 0, 0, 0, 0, 1, 0, 0, 1],\n",
       "       [0, 0, 0, 0, 0, 0, 1, 0, 0],\n",
       "       [1, 0, 0, 0, 0, 0, 0, 0, 0],\n",
       "       [0, 0, 0, 0, 0, 0, 0, 0, 1],\n",
       "       [0, 0, 1, 0, 0, 0, 0, 0, 0]])"
      ]
     },
     "execution_count": 22,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "test_labels[0:5]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "d362e5be",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([[0, 0, 0, 0, 0, 1, 0, 0, 1],\n",
       "       [0, 0, 0, 0, 0, 0, 0, 0, 0],\n",
       "       [1, 0, 0, 0, 0, 0, 1, 0, 0],\n",
       "       [0, 0, 0, 0, 0, 0, 0, 0, 1],\n",
       "       [0, 0, 1, 0, 0, 0, 0, 0, 0],\n",
       "       [1, 0, 0, 0, 0, 0, 0, 0, 0],\n",
       "       [0, 0, 0, 0, 0, 1, 0, 0, 1],\n",
       "       [0, 0, 1, 0, 0, 0, 0, 0, 1],\n",
       "       [0, 0, 0, 0, 0, 0, 1, 0, 0],\n",
       "       [0, 0, 1, 0, 0, 0, 0, 0, 0]])"
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pred_f[0:10]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "44195742",
   "metadata": {},
   "outputs": [],
   "source": [
    "with open('map_labels.json', 'r') as f:\n",
    "    map_labels = json.load(f)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "b7aa06e2",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "                      precision    recall  f1-score   support\n",
      "\n",
      "         Case Report       0.89      0.55      0.68       773\n",
      "           Diagnosis       0.90      0.61      0.73       297\n",
      "Epidemic Forecasting       0.87      0.69      0.77       954\n",
      "        General Info       0.94      0.59      0.72       104\n",
      "           Mechanism       1.00      0.06      0.11        18\n",
      "          Prevention       0.92      0.76      0.83       685\n",
      "        Transmission       0.84      0.78      0.81      1625\n",
      "           Treatment       0.77      0.15      0.25       153\n",
      "                           0.88      0.80      0.84      1347\n",
      "\n",
      "           micro avg       0.87      0.71      0.78      5956\n",
      "           macro avg       0.89      0.55      0.64      5956\n",
      "        weighted avg       0.87      0.71      0.77      5956\n",
      "         samples avg       0.75      0.72      0.73      5956\n",
      "\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/home/max/python/AML/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in samples with no predicted labels. Use `zero_division` parameter to control this behavior.\n",
      "  _warn_prf(average, modifier, msg_start, len(result))\n"
     ]
    }
   ],
   "source": [
    "print(metrics.classification_report(test_labels, pred_f, target_names=map_labels.keys()))\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "cb5c4cb0",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([0.93453766, 0.98128737, 0.96103343, 0.99595998, 0.97208702,\n",
       "       0.98264429, 0.94324878, 0.97873768, 0.96500063])"
      ]
     },
     "execution_count": 26,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "metrics.roc_auc_score(test_labels, svmpredDF, average=None)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "id": "483ba6fd",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "1.6086381665932128"
      ]
     },
     "execution_count": 27,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "metrics.coverage_error(test_labels, svmpredDF)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "id": "51b66e07",
   "metadata": {},
   "outputs": [],
   "source": [
    "confusion_matrix = metrics.multilabel_confusion_matrix(test_labels, pred_f)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "id": "c5902a5f",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Text(0.5, 1.0, 'General Info')"
      ]
     },
     "execution_count": 29,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 864x576 with 4 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(12, 8))\n",
    "\n",
    "disp1 = metrics.ConfusionMatrixDisplay(confusion_matrix[0]).plot(ax=ax1)\n",
    "disp1.ax_.set_title('Mechanism')\n",
    "\n",
    "disp2 = metrics.ConfusionMatrixDisplay(confusion_matrix[1]).plot(ax=ax2)\n",
    "disp2.ax_.set_title('General Info')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "id": "53a5207a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.6337593653591891"
      ]
     },
     "execution_count": 30,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "accuracy_score(test_labels, pred_f)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "id": "74d44291",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.7823104023734471"
      ]
     },
     "execution_count": 31,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "f1_score(test_labels, pred_f, average='micro')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "id": "002f3b43",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.8734989648033127"
      ]
     },
     "execution_count": 32,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "precision_score(test_labels, pred_f, average='micro')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "id": "bc0ee96b",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.7083613163196776"
      ]
     },
     "execution_count": 33,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/home/max/python/AML/lib/python3.8/site-packages/sklearn/svm/_base.py:985: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations.\n",
      "  warnings.warn(\"Liblinear failed to converge, increase \"\n",
      "/home/max/python/AML/lib/python3.8/site-packages/sklearn/svm/_base.py:985: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations.\n",
      "  warnings.warn(\"Liblinear failed to converge, increase \"\n",
      "/home/max/python/AML/lib/python3.8/site-packages/sklearn/svm/_base.py:985: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations.\n",
      "  warnings.warn(\"Liblinear failed to converge, increase \"\n",
      "/home/max/python/AML/lib/python3.8/site-packages/sklearn/svm/_base.py:985: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations.\n",
      "  warnings.warn(\"Liblinear failed to converge, increase \"\n",
      "/home/max/python/AML/lib/python3.8/site-packages/sklearn/svm/_base.py:985: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations.\n",
      "  warnings.warn(\"Liblinear failed to converge, increase \"\n",
      "/home/max/python/AML/lib/python3.8/site-packages/sklearn/svm/_base.py:985: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations.\n",
      "  warnings.warn(\"Liblinear failed to converge, increase \"\n",
      "/home/max/python/AML/lib/python3.8/site-packages/sklearn/svm/_base.py:985: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations.\n",
      "  warnings.warn(\"Liblinear failed to converge, increase \"\n",
      "/home/max/python/AML/lib/python3.8/site-packages/sklearn/svm/_base.py:985: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations.\n",
      "  warnings.warn(\"Liblinear failed to converge, increase \"\n",
      "/home/max/python/AML/lib/python3.8/site-packages/sklearn/svm/_base.py:985: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations.\n",
      "  warnings.warn(\"Liblinear failed to converge, increase \"\n"
     ]
    }
   ],
   "source": [
    "recall_score(test_labels, pred_f, average='micro')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0911c972",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.10"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
